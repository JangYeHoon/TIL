# AWS 서비스 비교 정리

- [DataSync vs Storage Gateway](#datasync-vs-storage-gateway)
- [Savings Plans vs Reserved Instances](#savings-plans-vs-reserved-instances)

## DataSync vs Storage Gateway

### DataSync

- AWS안에서 혹은 온프레미스에서 데이터를 이동하기 위한 서비스
  - AWS 스토리지 -> AWS 스토리지
  - 온프레미스 -> AWS 스토리지
- 다양한 AWS 스토리지 지원
  - S3, EFS, FSx, SnowCone(전송만 가능)
- Agent를 사용
  - VM으로 데이터의 소스를 읽어 AWS의 데이터 저장 서비스로 데이터를 전송
  - 동일한 AWS 계정에서 데이터를 전송할 땐 사용하지 않음
- 지원 프로토콜
  - NFS, SMB, HDFS, S3 API

#### 지원 기능

- 데이터의 전송 전 필터 적용 가능
- 스케쥴 설정 가능
- 데이터 무결성 검사
- 동시에 여러 소스에서 하나의 대상으로 전송 가능
- 전송 실패 시 재전송
- **주로 데이터의 전송 및 이동을 목적으로 하는 서비스**

### Storage Gateway

- 하이브리드 클라우드 스토리지 서비스 세트
- 하이브리드 환경에서 온프레미스에서 클라우드의 저장 서비스를 연동하기 위한 서비스
- Storage Gateway Appliance 사용
  - VM으로 온프레미스 데이터센터에 설치하여 데이터를 수집 및 전송
  - 혹은 AWS로부터 하드웨어를 구매해 설치 가능
- 종류
  - File Gateway : 데이터를 S3에 저장 후 NFS/SMB등으로 액세스
  - Volume Gateway : iSCSI 프로토콜로 데이터를 비동기적으로 EBS 스냅샷 형식으로 S3에 저장
    - Cashed Volume : 자주 사용되는 데이터만 로컬에 두고 모두 AWS에 백업
    - Stored Volume : 모든 데이터를 로컬에 저장하고 **비동기적으로** AWS에 백업
  - Tape Gateway : Tape 기반 백업 퍼플리케이션을 위한 서비스

### 서비스 차이점

|        내용        |               Data Sync                |             Sotrage Gateway              |
| :--------------: | :------------------------------------: | :--------------------------------------: |
|        목적        | AWS안에서 혹은 온프레미스에서 데이터를 **이동**하기 위한 서비스 | 하이브리드 환경에서 온프레미스에서 클라우드의 저장 서비스를 **연동**하기 위한 서비스 |
|      전송 필터       |           포함/제외 시킬 파일 지정 가능            |                    X                     |
|     지원 프로토콜      |         NFS, SMB, HDFS, S3 API         |             SMB, NFS, iSCSI              |
|      전송 대상       |              S3, EFS, FSx              |                    S3                    |
|      전송 서비스      |        온프레미스 -> AWS, AWS -> AWS        |               온프레미스 -> AWS               |
| S3 Glacier/DA 전송 |                   지원                   |        X(LifeCycle 정책으로 간접적으로 가능)        |
|     실패시 재전송      |                   O                    |                    X                     |
|      최대 쓰루풋      |                10gb/sec                |                500MB/sec                 |
|     데이터 엑세스      |                   X                    |                    O                     |

- DataSync : **데이터의 전송을 위한 서비스**
  - 데이터를 잘 전달하기 위한 기능으로 구성
    - 데이터 필터, 무결성 검사, 스케쥴링, 재시도 등
  - 다양한 서비스/주체간 데이터 전송 지원
- Storage Gateway : **온프레미스 환경에서 AWS의 스토리지를 이용하기 위한 서비스(주로 백업)**
  - 데이터를 클라우드에 저장하고 사용하거나 백업하기 위한 기능
    - 온프레미스에서 클라우드 환경의 데이터를 엑세스 가능
  - 테이프 기반 백업 어플리케이션 지원

## Savings Plans vs Reserved Instances

- 약정 할인
- On-Demand 인스턴스
  - 유연성
  - 기간을 정하지 않고 사용
  - 언제든지 중지 가능
  - 언제든지 서비스 옵션 변경 가능
  - 사용한 만큼 비용 지불
  - **비싼 단가**
- Reserved Instances/Savings Plans
  - 일정 기간을 정하여 사용
  - 약정 기간 내 중지 불가능
  - (경우에 따라) 서비스 옵션 변경 불가능
  - 일정 가격을 정해 미리 지불
  - **저렴한 단가**
  - **인스턴스 예약 등의 부가 기능**

### Reserved Instance

- Amazon EC2 사용 비용을 절감해주는 결제 할인 혜택
- EC2를 기간 약정하여 요금을 할인 받는 방식(최대 72%)
- 제공 클래스
  - 표준 - 큰 할인 혜택, 단 교환 불가능(수정만 가능)
  - 컨버터블 - 낮은 할인 혜택, 다른 속서의 예약 인스턴스로 교환 가능
- 제공 범위
  - 리전 - 리전 전체에서 사용, **용량 예약 불가능**, 인스턴스 패밀리 단위
  - 영역 - 특정 가용영역에서만 사용, **용량 예약 가능**

> 특정 인스턴스 유형이 해당 가용영역에 있을거란 보장이 없다. 그래서 자기가 원할 때 특정 유형을 사용할 수 있도록 용량 예약을 하면 가능하다.

### Savings Plans

- 1년 또는 3년 기간에 특정 **사용량 약정**을 조건으로, 온디맨드 요금에 비해 보다 저렴한 요금을 제공하는 **유연한 요금 모델**
- Compute Savings Plans
  - 컴퓨팅 파워의 사용량을 약정하는 요금 모델
  - 컴퓨팅 파워를 사용하는 EC2, AWS Lambda, AWS Fargate에서 사용 가능
  - 인스턴스 패밀리, 크기, AZ. 리전, OS, 태넌시 등에 관계없이 사용량에 적용
  - 리전, 인스턴스 패밀리, 서비스(EC2->Fargate) 변경 가능
  - 최대 66% 할인
  - **가장 유연한 요금 모델**
- EC2 Instance Savings Plans
  - 특정 리전의 특정 인스턴스 패밀리를 선택해 사용을 약정하는 요금 모델
  - 사이즈, OS, 태넌시(Host, Dedicated, Default)의 약정 없이 사용
  - 같은 패밀리 타입(ex. M5이라면 사이즈 변경, OS 변경 등이 가능
  - 리전 변경 불가능
  - 최대 75% 할인
- SageMaker Savings Plans

### 서비스 차이점

| 내용                  | Compute Savings Plans | EC2 Instance Savings Plans | Convertible RIs                            | Standard RIs                               |
| --------------------- | --------------------- | -------------------------- | ------------------------------------------ | ------------------------------------------ |
| 약정                  | 컴퓨팅 파워를 약정    | EC2 인스턴스 패밀리를 약정 | 사용 기간 약정                             | 사용 기간 약정                             |
| 인스턴스 패밀리 약정  | 약정 없음             | 약정                       | 약정(교체가능)                             | 약정                                       |
| 인스턴스 사이즈 약정  | 약정 없음             | 약정 없음                  | Regional의 경우 비약정 / Zonal의 경우 약정 | Regional의 경우 비약정 / Zonal의 경우 약정 |
| OS 약정               | 약정 없음             | 약정 없음                  | 약정                                       | 약정                                       |
| 리전 약정             | 약정 없음             | 약정                       | 약정                                       | 약정                                       |
| Fargate / Lambda 적용 | 가능                  | 불가능                     | 불가능                                     | 가능                                       |
| 판매 가능             | 불가능                | 불가능                     | 불가능                                     | 가능                                       |
| 대용량 할인           | 불가능                | 불가능                     | 가능                                       | 가능                                       |
| 최대 할인율           | 66%                   | 72%                        | 66%                                        | 72%                                        |
| M5 large 1년 할인율   | 33%                   | 42%                        | 33%                                        | 42$                                        |

#### Reserved Instance

- **사용 기간을 약정해서 할인 받는 모델**
- 1~3년의 사용 기간을 약정해서 할인
- **용량 확보 가능**
- **판매, 교체 가능**
- 대용량 할인 존재
- Savings Plan에 비해 다소 제약사항이 많음
- RDS, EC2, Redshift, Elastic Cache 등 인스턴스 기반 서비스에 모두 사용 가능
- **좀 더 세세한 관리가 가능하나 신경 쓸 점도 많음**
  - 구매한 RI가 어떤 인스턴스에 쓰일지 등에 대한 세세한 컨트롤 가능
  - 다만 비교적 약정 내용이 더 많음

#### Savings Plan

- **사용량 혹은 인스턴스 패밀리를 약정해서 할인받는 요금 모델**
- RI에 비해 유연함
  - Compute Savings Plan의 경우 - 리전, 패밀리, OS, 태넌시 등에 관계없이 할인
- 용량 예약 불가능
  - 필요 시 On-Demand Capacity Reservations 사용 가능
- 판매 불가능
- **약간 덜 관리하고 덜 할인받는 모델**
  - 설정해두면 여러 혜택을 자동으로 분배하지만, 세세한 컨트롤 불가능